<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/test/java/pt/feup/tvvs/pacman/viewer/ViewerFactoryWhiteBoxTests.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/test/java/pt/feup/tvvs/pacman/viewer/ViewerFactoryWhiteBoxTests.java" />
              <option name="originalContent" value="package pt.feup.tvvs.pacman.viewer;&#10;&#10;public class ViewerFactoryWhiteBoxTests {&#10;}&#10;&#10;&#10;&#10;" />
              <option name="updatedContent" value="package pt.feup.tvvs.pacman.viewer;&#10;&#10;import com.googlecode.lanterna.graphics.BasicTextImage;&#10;import org.junit.jupiter.api.Test;&#10;import org.mockito.MockedStatic;&#10;import pt.feup.tvvs.pacman.model.Element;&#10;import pt.feup.tvvs.pacman.model.game.element.Wall;&#10;import pt.feup.tvvs.pacman.model.game.element.collectibles.Coin;&#10;import pt.feup.tvvs.pacman.model.game.element.GhostGate;&#10;import pt.feup.tvvs.pacman.model.game.element.ghost.Blinky;&#10;import pt.feup.tvvs.pacman.model.game.element.ghost.Clyde;&#10;import pt.feup.tvvs.pacman.model.game.element.ghost.Inky;&#10;import pt.feup.tvvs.pacman.model.game.element.ghost.Pinky;&#10;import pt.feup.tvvs.pacman.model.game.element.pacman.Pacman;&#10;import pt.feup.tvvs.pacman.model.menu.element.TextBox;&#10;import pt.feup.tvvs.pacman.viewer.game.ImageLoader;&#10;&#10;import java.awt.image.BufferedImage;&#10;import java.io.IOException;&#10;import java.util.*;&#10;&#10;import static org.assertj.core.api.Assertions.assertThat;&#10;import static org.mockito.ArgumentMatchers.anyString;&#10;import static org.mockito.Mockito.atLeastOnce;&#10;import static org.mockito.Mockito.mockStatic;&#10;&#10;public class ViewerFactoryWhiteBoxTests {&#10;&#10;    private Map&lt;Character, BufferedImage&gt; makeFontImages() {&#10;        Map&lt;Character, BufferedImage&gt; font = new HashMap&lt;&gt;();&#10;        font.put('A', new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB));&#10;        font.put('B', new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB));&#10;        return font;&#10;    }&#10;&#10;    private Map&lt;Character, List&lt;BufferedImage&gt;&gt; makePacmanImages() {&#10;        Map&lt;Character, List&lt;BufferedImage&gt;&gt; m = new HashMap&lt;&gt;();&#10;        m.put('L', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('U', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('D', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('R', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('X', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        return m;&#10;    }&#10;&#10;    private Map&lt;Character, List&lt;BufferedImage&gt;&gt; makeGhostImages() {&#10;        Map&lt;Character, List&lt;BufferedImage&gt;&gt; m = new HashMap&lt;&gt;();&#10;        m.put('L', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('U', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('D', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('R', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('S', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB), new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('r', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('l', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('u', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        m.put('d', List.of(new BufferedImage(2,2,BufferedImage.TYPE_INT_ARGB)));&#10;        return m;&#10;    }&#10;&#10;    @Test&#10;    public void createArenaViewers_returns_expected_viewers_and_uses_ImageLoader() throws Exception {&#10;        try (MockedStatic&lt;ImageLoader&gt; loader = mockStatic(ImageLoader.class)) {&#10;            // stub ImageLoader&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/wall.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/ghostgate.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/items/coin.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/items/apple.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/items/cherry.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/items/key.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/items/orange.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/items/strawberry.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/items/powerup.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;&#10;            loader.when(ImageLoader::loadFontImages).thenReturn(makeFontImages());&#10;            loader.when(ImageLoader::loadPacmanImages).thenReturn(makePacmanImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;blinky&quot;)).thenReturn(makeGhostImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;pinky&quot;)).thenReturn(makeGhostImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;inky&quot;)).thenReturn(makeGhostImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;clyde&quot;)).thenReturn(makeGhostImages());&#10;&#10;            Map&lt;Class&lt;?&gt;, Viewer&lt;Element&gt;&gt; viewers = ViewerFactory.createArenaViewers();&#10;&#10;            // assert viewers contains expected keys&#10;            assertThat(viewers).containsKeys(Wall.class, GhostGate.class, Coin.class, TextBox.class, Pacman.class, Blinky.class, Pinky.class, Inky.class, Clyde.class);&#10;&#10;            // assert viewer classes (TextBoxViewer and MovableElementViewer should be present)&#10;            assertThat(viewers.get(TextBox.class)).isInstanceOf(TextBoxViewer.class);&#10;            assertThat(viewers.get(Pacman.class)).isNotNull();&#10;            assertThat(viewers.get(Blinky.class)).isNotNull();&#10;&#10;            // verify ImageLoader was called for major resources&#10;            loader.verify(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/wall.png&quot;));&#10;            loader.verify(ImageLoader::loadFontImages);&#10;            loader.verify(ImageLoader::loadPacmanImages);&#10;            loader.verify(() -&gt; ImageLoader.loadGhostImages(&quot;blinky&quot;));&#10;        }&#10;    }&#10;&#10;    @Test&#10;    public void createMainMenuViewers_returns_expected_viewers_and_uses_ImageLoader() throws Exception {&#10;        try (MockedStatic&lt;ImageLoader&gt; loader = mockStatic(ImageLoader.class)) {&#10;            loader.when(ImageLoader::loadFontImages).thenReturn(makeFontImages());&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/pacman/pacmanright.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;blinky&quot;)).thenReturn(makeGhostImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;pinky&quot;)).thenReturn(makeGhostImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;inky&quot;)).thenReturn(makeGhostImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;clyde&quot;)).thenReturn(makeGhostImages());&#10;&#10;            Map&lt;Class&lt;?&gt;, Viewer&lt;Element&gt;&gt; viewers = ViewerFactory.createMainMenuViewers();&#10;&#10;            assertThat(viewers).containsKey(TextBox.class);&#10;            assertThat(viewers.get(TextBox.class)).isInstanceOf(TextBoxViewer.class);&#10;            assertThat(viewers).containsKey(Pacman.class);&#10;&#10;            loader.verify(ImageLoader::loadFontImages);&#10;            loader.verify(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/pacman/pacmanright.png&quot;));&#10;            loader.verify(() -&gt; ImageLoader.loadGhostImages(&quot;blinky&quot;));&#10;        }&#10;    }&#10;&#10;    @Test&#10;    public void createPauseMapSelectionAndAlertViewers_return_textboxviewer_and_alert_delegates() throws Exception {&#10;        try (MockedStatic&lt;ImageLoader&gt; loader = mockStatic(ImageLoader.class)) {&#10;            loader.when(ImageLoader::loadFontImages).thenReturn(makeFontImages());&#10;&#10;            Map&lt;Class&lt;?&gt;, Viewer&lt;Element&gt;&gt; pause = ViewerFactory.createPauseMenuViewers();&#10;            assertThat(pause).containsKey(TextBox.class);&#10;            assertThat(pause.get(TextBox.class)).isInstanceOf(TextBoxViewer.class);&#10;&#10;            Map&lt;Class&lt;?&gt;, Viewer&lt;Element&gt;&gt; mapSel = ViewerFactory.createMapSelectionMenuViewers();&#10;            assertThat(mapSel).containsKey(TextBox.class);&#10;&#10;            // For alert menu, stub the full arena loaders so delegation occurs&#10;            loader.when(() -&gt; ImageLoader.loadTextImage(&quot;PNGs/wall.png&quot;)).thenReturn(new BasicTextImage(11,11));&#10;            loader.when(ImageLoader::loadPacmanImages).thenReturn(makePacmanImages());&#10;            loader.when(() -&gt; ImageLoader.loadGhostImages(&quot;blinky&quot;)).thenReturn(makeGhostImages());&#10;            loader.when(ImageLoader::loadFontImages).thenReturn(makeFontImages());&#10;&#10;            Map&lt;Class&lt;?&gt;, Viewer&lt;Element&gt;&gt; alert = ViewerFactory.createAlertMenuViewers();&#10;            assertThat(alert).containsKey(Wall.class);&#10;&#10;            loader.verify(ImageLoader::loadFontImages, atLeastOnce());&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>